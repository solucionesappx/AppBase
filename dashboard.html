<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>App JAL7</title>
    <!-- Incluye el CDN de Tailwind CSS para un estilo rápido y moderno -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Incluye la librería de iconos Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.5.1/css/all.css">
    <style>
        /* ... (todo el CSS igual que antes) ... */
    </style>
</head>
<body class="dark-mode min-h-screen flex flex-col">
    <!-- 1. Cintillo Fijo (Header) -->
    <header class="fixed top-0 left-0 w-full header-bg box-shadow-down z-50 transition-colors">
        <div class="container max-w-lg mx-auto px-4 py-3 flex items-center justify-between">
            <!-- Mensaje de Bienvenida (Asume que el usuario está logueado) -->
            <div class="flex-row space-x-2">
                <span class="text-2xl font-semibold">¡Hola, Usuario!</span>
            </div>

            <div class="flex-row space-x-4 flex items-center">
                <!-- Botón de Modo Claro/Oscuro -->
                <div id="theme-toggle" class="toggle-switch-container dark-mode">
                    <div class="toggle-button"></div>
                </div>
                
                <!-- Botón para cerrar sesión -->
                <button id="logoutBtn" class="nav-link text-xl text-[var(--text-color)] hover:text-red-500 transition-colors">
                    <!-- Icono de cerrar sesión de Font Awesome -->
                    <i class="fa-solid fa-right-from-bracket"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- ... (resto del HTML igual) ... -->

    <script>
        const themeToggle = document.getElementById('theme-toggle');
        const body = document.body;

        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            body.classList.add('dark-mode');
            themeToggle.classList.add('dark-mode');
        }

        themeToggle.addEventListener('click', () => {
            body.classList.toggle('dark-mode');
            themeToggle.classList.toggle('dark-mode');
            if (body.classList.contains('dark-mode')) {
                localStorage.setItem('theme', 'dark');
            } else {
                localStorage.setItem('theme', 'light');
            }
        });

        document.addEventListener("DOMContentLoaded", () => {
            // --- NUEVO: Validar y mostrar nombre de usuario ---
            const userData = JSON.parse(localStorage.getItem('userData'));
            if (!userData) {
                window.location.href = 'index.html';
                return;
            }
            // Mostrar el nombre de usuario en el header
            const usuarioSpan = document.querySelector('.header-bg .text-2xl.font-semibold');
            if (usuarioSpan && userData.username) {
                usuarioSpan.textContent = `¡Hola, ${userData.username}!`;
            }

            // ... resto del contenido JS existente ...
            const DataGridBody = document.querySelector('#Data-grid tbody');
            // ... (todo el JS permanece igual) ...

            // --- Lógica de navegación y modales nuevos ---
            const logoutBtn = document.getElementById('logoutBtn');
            // ... (otros botones) ...

            // ... (funciones de mostrar/ocultar modales) ...

            // Agrega event listeners a los botones de navegación
            logoutBtn.addEventListener('click', () => {
                // Limpiar userData y simular la navegación a index.html
                localStorage.removeItem('userData');
                window.location.href = 'index.html';
            });

            // ... (resto de los event listeners igual) ...

            loadPersonData();
        });
    </script>
</body>
</html>
